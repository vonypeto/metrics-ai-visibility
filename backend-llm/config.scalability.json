{
  "description": "Example configurations demonstrating scalability features",
  "runs": [
    {
      "name": "Small Run - Default Settings",
      "prompts": [
        "What is the best payment processor?",
        "Which CRM should I use?"
      ],
      "brands": ["Stripe", "PayPal", "Salesforce"],
      "models": [{ "model": "gpt-4o-mini", "provider": "openai" }],
      "notes": "Basic run with default settings (concurrency: 5, retries: 3)"
    },

    {
      "name": "Medium Run - With Idempotency",
      "prompts": [
        "Best project management tools for teams",
        "Top email marketing platforms",
        "Leading analytics solutions"
      ],
      "brands": ["Asana", "Monday.com", "Mailchimp", "Google Analytics"],
      "models": [
        { "model": "gpt-4o-mini", "provider": "openai" },
        { "model": "claude-3-5-haiku-20241022", "provider": "anthropic" }
      ],
      "idempotencyKey": "campaign-001-2024",
      "notes": "Safe to retry - idempotency key prevents duplicates"
    },

    {
      "name": "Large Run - High Concurrency",
      "prompts": [
        "What is Stripe?",
        "Tell me about PayPal",
        "Explain Square payments",
        "What is Adyen?",
        "Describe Braintree"
      ],
      "brands": [
        "Stripe",
        "PayPal",
        "Square",
        "Adyen",
        "Braintree",
        "Checkout.com",
        "Klarna"
      ],
      "models": [
        { "model": "gpt-4o-mini", "provider": "openai" },
        { "model": "gpt-4o", "provider": "openai" },
        { "model": "claude-3-5-haiku-20241022", "provider": "anthropic" }
      ],
      "config": {
        "concurrencyLimit": 20,
        "retryAttempts": 3,
        "timeout": 30000,
        "rateLimitPerSecond": 50,
        "enableCircuitBreaker": true
      },
      "notes": "High throughput: 20 parallel requests, 50/sec rate limit"
    },

    {
      "name": "Production Run - Full Configuration",
      "prompts": [
        "Compare payment processors for e-commerce",
        "Best payment gateway for subscriptions",
        "International payment solutions",
        "Payment processing fees comparison",
        "PCI compliance requirements"
      ],
      "brands": [
        "Stripe",
        "PayPal",
        "Square",
        "Adyen",
        "Braintree",
        "Authorize.net",
        "Worldpay"
      ],
      "models": [
        { "model": "gpt-4o-mini", "provider": "openai" },
        { "model": "gpt-4o", "provider": "openai" },
        { "model": "claude-3-5-sonnet-20241022", "provider": "anthropic" },
        { "model": "claude-3-5-haiku-20241022", "provider": "anthropic" }
      ],
      "idempotencyKey": "production-batch-001",
      "config": {
        "concurrencyLimit": 15,
        "retryAttempts": 5,
        "timeout": 45000,
        "rateLimitPerSecond": 30,
        "enableCircuitBreaker": true
      },
      "notes": "Production-ready: idempotency, circuit breaker, aggressive retries"
    },

    {
      "name": "Conservative Run - Safe Settings",
      "prompts": ["What is HubSpot?", "Describe Salesforce CRM"],
      "brands": ["HubSpot", "Salesforce"],
      "models": [{ "model": "gpt-4o-mini", "provider": "openai" }],
      "config": {
        "concurrencyLimit": 2,
        "retryAttempts": 2,
        "timeout": 20000,
        "enableCircuitBreaker": true
      },
      "notes": "Conservative: low concurrency, short timeout, circuit breaker on"
    },

    {
      "name": "Stress Test - 50 Prompts x 2 Models",
      "prompts": [
        "Prompt 1: Payment processing",
        "Prompt 2: E-commerce platforms",
        "Prompt 3: Marketing automation",
        "Prompt 4: Analytics tools",
        "Prompt 5: CRM systems",
        "Prompt 6: Project management",
        "Prompt 7: Communication tools",
        "Prompt 8: HR software",
        "Prompt 9: Accounting systems",
        "Prompt 10: Inventory management",
        "Prompt 11: Customer support",
        "Prompt 12: Email marketing",
        "Prompt 13: Social media tools",
        "Prompt 14: SEO platforms",
        "Prompt 15: Content management",
        "Prompt 16: Video conferencing",
        "Prompt 17: File storage",
        "Prompt 18: Password managers",
        "Prompt 19: Design tools",
        "Prompt 20: Development platforms",
        "Prompt 21: Testing frameworks",
        "Prompt 22: CI/CD tools",
        "Prompt 23: Monitoring systems",
        "Prompt 24: Security software",
        "Prompt 25: Database systems",
        "Prompt 26: Cloud platforms",
        "Prompt 27: Container orchestration",
        "Prompt 28: API gateways",
        "Prompt 29: Message queues",
        "Prompt 30: Cache systems",
        "Prompt 31: Load balancers",
        "Prompt 32: CDN services",
        "Prompt 33: DNS providers",
        "Prompt 34: SSL certificates",
        "Prompt 35: Backup solutions",
        "Prompt 36: Disaster recovery",
        "Prompt 37: Compliance tools",
        "Prompt 38: Legal software",
        "Prompt 39: Time tracking",
        "Prompt 40: Expense management",
        "Prompt 41: Invoice systems",
        "Prompt 42: Payroll software",
        "Prompt 43: Benefits platforms",
        "Prompt 44: Recruiting tools",
        "Prompt 45: Training systems",
        "Prompt 46: Documentation tools",
        "Prompt 47: Wiki platforms",
        "Prompt 48: Knowledge bases",
        "Prompt 49: Forum software",
        "Prompt 50: Community platforms"
      ],
      "brands": ["Stripe", "PayPal", "Salesforce", "HubSpot"],
      "models": [
        { "model": "gpt-4o-mini", "provider": "openai" },
        { "model": "claude-3-5-haiku-20241022", "provider": "anthropic" }
      ],
      "idempotencyKey": "stress-test-001",
      "config": {
        "concurrencyLimit": 25,
        "retryAttempts": 3,
        "timeout": 30000,
        "rateLimitPerSecond": 50,
        "enableCircuitBreaker": true
      },
      "notes": "Stress test: 100 total requests (50 prompts Ã— 2 models). Tests concurrency, rate limiting, circuit breaker under load."
    }
  ],

  "configuration_guide": {
    "concurrencyLimit": {
      "description": "Maximum number of parallel LLM API requests",
      "default": 5,
      "recommended": {
        "small": "2-5",
        "medium": "10-15",
        "large": "20-30"
      },
      "notes": "Higher = faster but more load. Consider your rate limits."
    },

    "retryAttempts": {
      "description": "Number of retries for failed requests",
      "default": 3,
      "recommended": {
        "development": "2-3",
        "production": "3-5"
      },
      "notes": "Each retry uses exponential backoff with jitter"
    },

    "timeout": {
      "description": "Request timeout in milliseconds",
      "default": 30000,
      "recommended": {
        "fast_models": "20000-30000",
        "slow_models": "45000-60000"
      },
      "notes": "Should be longer than expected response time"
    },

    "rateLimitPerSecond": {
      "description": "Maximum requests per second (future use with global limiter)",
      "default": "provider_default",
      "recommended": {
        "openai": "50 (tier dependent)",
        "anthropic": "50",
        "conservative": "10-20"
      },
      "notes": "Currently per-worker, will be global with Redis"
    },

    "enableCircuitBreaker": {
      "description": "Enable circuit breaker pattern for provider failures",
      "default": true,
      "recommended": "Always true in production",
      "notes": "Prevents cascading failures. Opens after 5 failures, tests recovery after 60s."
    },

    "idempotencyKey": {
      "description": "Client-provided unique key for deduplication",
      "required": false,
      "recommended": "Use for batch jobs and retryable operations",
      "format": "String, unique per logical run",
      "examples": [
        "campaign-001-2024",
        "user-123-batch-456",
        "daily-report-2024-12-02"
      ],
      "notes": "Same key returns existing run. Good for retry scenarios."
    }
  },

  "scalability_features": {
    "circuit_breaker": {
      "description": "Automatically opens circuit after repeated failures, prevents cascading",
      "states": ["CLOSED (healthy)", "OPEN (failing)", "HALF_OPEN (testing)"],
      "config": {
        "failureThreshold": 5,
        "successThreshold": 2,
        "timeout": 60000
      }
    },

    "rate_limiting": {
      "description": "Token bucket algorithm with burst support",
      "features": [
        "Per-provider limits",
        "Automatic queuing",
        "Dynamic configuration",
        "Burst capacity"
      ],
      "providers": {
        "openai": "maxConcurrent: 50, minTime: 20ms (50 req/s)",
        "anthropic": "maxConcurrent: 50, minTime: 20ms (50 req/s)"
      }
    },

    "idempotency": {
      "description": "Three-level deduplication system",
      "levels": [
        "Idempotency key (client-provided)",
        "Content hash (automatic, SHA-256)",
        "Entity deduplication (findOrCreate)"
      ],
      "behavior": "Returns existing run within 5 minutes for same content"
    },

    "retry_logic": {
      "description": "Exponential backoff with jitter",
      "schedule": [
        "Retry 1: ~1.5s (1000ms + jitter)",
        "Retry 2: ~2.5s (2000ms + jitter)",
        "Retry 3: ~4.5s (4000ms + jitter)"
      ],
      "jitter": "Random 0-1000ms to prevent thundering herd"
    },

    "metrics": {
      "description": "Comprehensive tracking for monitoring and optimization",
      "tracked": [
        "Total run duration",
        "Average latency per request",
        "Total tokens used",
        "Estimated cost ($USD)",
        "Success/failure counts",
        "Retry counts"
      ]
    }
  },

  "performance_benchmarks": {
    "single_instance": {
      "capacity": "100,000 prompts/day",
      "throughput": "~4-5 requests/second",
      "memory": "~200MB baseline",
      "bottleneck": "LLM provider rate limits, not our system"
    },

    "scaled_deployment": {
      "capacity": "1,000,000+ prompts/day",
      "workers": "10-20 pods",
      "throughput": "~250-500 requests/second",
      "additional_infrastructure": [
        "Redis (job queue + rate limiter)",
        "MongoDB replica set",
        "Load balancer"
      ]
    }
  },

  "cost_estimates": {
    "100k_prompts_per_day": {
      "llm_costs": "$7,222/month",
      "infrastructure": "$1,678/month",
      "total": "$8,900/month",
      "per_prompt": "$0.003"
    },

    "1m_prompts_per_day": {
      "llm_costs": "$72,000/month (baseline)",
      "infrastructure": "$5,000/month",
      "optimized_total": "$34,600/month (with caching + batch API)",
      "savings": "55% reduction"
    }
  },

  "documentation": {
    "SCALABILITY.md": "Comprehensive architecture guide for 100k+ prompts/day",
    "SCALABILITY_SUMMARY.md": "Quick summary of features and design decisions",
    "README.md": "Project overview and quick start",
    "LLM_VISIBILITY_README.md": "Full API documentation"
  }
}
